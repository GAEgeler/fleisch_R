{
    "collab_server" : "",
    "contents" : "#####\n## Fragebogen Verteilt und Rücklauf \n#####\n\n# status: 21.06.18\nsetwd(\"S:/pools/n/N-IUNR-nova-data/01_befragung/quant/01_analysen/06_explorative/Plots\")\n# required libraries\nlibrary(dplyr)\nlibrary(tibble)\nlibrary(ggplot2)\nlibrary(readr)\nlibrary(forcats)\nlibrary(ggplus)\nlibrary(ggforce)\nlibrary(waffle)\nlibrary(extrafont)\nlibrary(stringr)\n\n\n#Theme kopiert von Egeler\nlibrary(extrafont) # be carefull with device = \"postscript\"\nloadfonts() # takes a while for loading all fonts\n# somehow, not working with postscript\n\n### MY Theme 1: for regular plots -------------------\n\nmytheme <- theme_bw()+ # definve theme for plot\n  theme(plot.title = element_text(size = 20, face = \"bold\")) +\n  theme(text = element_text(size=20),axis.title.y = element_text(size = 20)) +\n  theme(axis.title.x = element_text(size = 20)) +\n  theme(legend.text = element_text(size = 20),legend.title = element_text(size =20)) +\n  theme(axis.title.y = element_text(size = 20, margin = margin(t = 0, r = 20, b = 0, l = 0)))+\n  theme(axis.title.x = element_text(size = 20,  margin = margin(t = 20, r = 0, b = 0, l = 0)))\n\n#Histogramm für die Verteilten und zurückgekommenen Fragebogen\n#Agregiert\n\n\n\ndf_ <- read_delim(\"S:/pools/n/N-IUNR-nova-data/01_befragung/quant/01_analysen/06_explorative/Fragebogen_Rücklauf_180621.csv\", delim = ';', locale=locale(encoding = \"ISO-8859-2\"))\nggplot(df_, aes(x=fct_inorder(Datum), y=Anzahl, fill=Status)) +\ngeom_bar(stat=\"identity\",  width = 0.6, position=position_dodge()) +\nscale_fill_manual(\"Status\", values=c(\"Verteilt\"=\"#fad60d\", \"Zurückgekommen\"=\"#c5b87c\"))+\n\nxlab(\"Datum\") +\nylab(\"Anzahl Fragebogen\")+\ngeom_text(aes(y=df_$Anzahl+4), label=ifelse(is.na(df_$Quote),\"\", paste0(df_$Quote, \"%\")),  position = position_dodge(width = .7), size=4, fontface='bold')+\n  mytheme+\n  \n  ggsave(\"S:/pools/n/N-IUNR-nova-data/01_befragung/quant/01_analysen/06_explorative/Plots/verteilte_Fragebogen.pdf\",\n         width = 17,\n         height = 8,\n         dpi=600,\n         units=\"in\",\n         device=\"pdf\")\n\n#Histogramm bezüglich der Anzahl Fragebogen mit den Verschiedenen Komponenten\n\n#Agregiert\n\ndf_<- read_delim(\"S:\\\\pools\\\\n\\\\N-IUNR-nova-data\\\\01_befragung\\\\quant\\\\01_analysen\\\\03_bereinigung\\\\02_alle\\\\bereinigter_grundatensatz_fb_180503_04vori.csv\",  delim = ';', locale=locale(encoding = \"ISO-8859-2\"))\ndf_$content[df_$meal==\"Hot & Cold\"] <- 'H&C'\n\n\n\n  ggplot(df_, aes(meal, fill=meal))+\n    geom_bar(stat=\"count\", width = 0.6, position=position_dodge()) +\n\n    labs(x = 'Anzahl',y='Menülinie')+\n    scale_fill_manual(\"Menülinie\", values = c(\"Hot & Cold\"=\"#80ccff\",\"Favorite\" = \"#c5b87c\",\"Kitchen\" = \"#008099\",\"World\"=\"#fad60d\", \"Selber\"=\"#e64d00\"), na.value=\"#262626\")+\n    mytheme\n  \n  \n  ggsave(\"S:/pools/n/N-IUNR-nova-data/01_befragung/quant/01_analysen/06_explorative/Plots/Fragebogen_Aggregiert.pdf\",\n         width = 17,\n         height = 8,\n         dpi=600,\n         units=\"in\",\n         device=\"pdf\")\n\n#Nach Datum aufgeteilt\n\ndf_<- read_delim(\"S:\\\\pools\\\\n\\\\N-IUNR-nova-data\\\\01_befragung\\\\quant\\\\01_analysen\\\\03_bereinigung\\\\02_alle\\\\bereinigter_grundatensatz_fb_180503_04vori.csv\",  delim = ';', locale=locale(encoding = \"ISO-8859-2\"))\ndf_$content[df_$meal==\"Hot & Cold\"] <- 'H&C'\n# df_$content[df_$meal==\"Selber\"] <- 'S'\n# df_tot$content<-recode(df_tot$content, \"P*\"=\"P\")\ndf_$date <- as.POSIXct(strptime(df_$date,format=\"%d. %m. %Y\"))\n\ndf_2<- read_delim(\"S:\\\\pools\\\\n\\\\N-IUNR-nova-data\\\\01_befragung\\\\quant\\\\01_analysen\\\\06_explorative\\\\tilldata_survey_180626_01vori.csv\",  delim = ';', locale=locale(encoding = \"ISO-8859-2\"))\ndf_2$date <- as.POSIXct(strptime(df_2$date,format=\"%d. %m. %Y\"))\ndf_<- full_join(df_, df_2)\n\n  for (i in 1:2) {\n  ggplot(df_, aes(meal, fill=meal))+\n    geom_bar(stat=\"count\", width = 0.6, position=position_dodge()) +\n    facet_wrap(~as.Date(date))+\n    labs(x = 'Anzahl',y='Menülinie')+\n      geom_text(aes(y=df_$verteilt,   label = sprintf('%.2f%%', df_$pro_verteilt,inherit.aes = FALSE)))+\n  scale_fill_manual(\"Menülinie\", values = c(\"Hot & Cold\"=\"#80ccff\",\"Favorite\" = \"#c5b87c\",\"Kitchen\" = \"#008099\",\"World\"=\"#fad60d\", \"Selber\"=\"#e64d00\"), na.value=\"#262626\")+\n    facet_wrap_paginate(~date, ncol = 2, nrow = 2, page = i,\n                        strip.position=\"top\")+\n      \n    \n      mytheme\n    \n  \n  ggsave(paste(\"Fragebogen_Menülinien\", i, \".pdf\", sep=\"\"), height = 8, width = 17 , dpi = 600)\n  }\n\n#Histogramm bezüglich Ernährungsverhalten nur einmal ausgefüllt\n  \ndf_<- read_delim(\"S:\\\\pools\\\\n\\\\N-IUNR-nova-data\\\\01_befragung\\\\quant\\\\01_analysen\\\\03_bereinigung\\\\02_alle\\\\bereinigter_grundatensatz_fb_180503_04vori.csv\",  delim = ';', locale=locale(encoding = \"ISO-8859-2\"))\ndf_ <- subset(df_, fill==0)\n\ndf_$meat <- factor(df_$meat, levels = c(\"2x und mehr pro Tag\", \"1x pro Tag\", \"5-6x pro Woche\", \"3-4x pro Woche\", \"1-2x pro Woche\", \"1-2x pro Monat\", \"nie\", \"Unbekannt\"))\ndf_$meat[is.na(df_$meat)]=\"Unbekannt\"\n\ndf_$milk <- factor(df_$milk, levels = c(\"3x und mehr pro Tag\", \"1-2x pro Tag\", \"5-6x pro Woche\", \"3-4x pro Woche\", \"1-2x pro Woche\", \"1-2x pro Monat\", \"nie\", \"Unbekannt\"))\ndf_$milk[is.na(df_$milk)]=\"Unbekannt\"\n\ndf_$veget <- factor(df_$veget, levels = c(\"immer\", \"meistens\", \"oft\", \"manchmal\", \"selten\", \"nie\", \"Unbekannt\"))\ndf_$veget[is.na(df_$veget)]=\"Unbekannt\"\n\ndf_$veg <- factor(df_$veg, levels = c(\"immer\", \"meistens\", \"oft\", \"manchmal\", \"selten\", \"nie\", \"Unbekannt\"))\ndf_$veg[is.na(df_$veg)]=\"Unbekannt\"\n\nggplot(df_, aes(meat, fill=meat))+\n  geom_bar(stat=\"count\",  width = 0.6, position=position_dodge()) +\n  labs(x = 'Fleischkonsum',y='Anzahl')+\n  scale_fill_manual(\"\",values = c(\"2x und mehr pro Tag\"= \"#c5b87c\", \"1x pro Tag\"=\"#008099\", \"5-6x pro Woche\"=\"#fad60d\", \"3-4x pro Woche\"=\"#9ed129\", \"1-2x pro Woche\"=\"#e64d00\", \"1-2x pro Monat\"=\"#80ccff\", \"nie\"=\"#262626\", \"Unbekannt\"=\"grey90\"))+\n  scale_x_discrete(labels = function(x) str_wrap(x, width = 10))+\n  mytheme+\nggsave(\"S:/pools/n/N-IUNR-nova-data/01_befragung/quant/01_analysen/06_explorative/Plots/Fleischkonsum.pdf\",\n       width = 18,\n       height = 8,\n       dpi=600,\n       units=\"in\",\n       device=\"pdf\")\n\nggplot(df_, aes(milk, fill=milk))+\n  geom_bar(stat=\"count\", width = 0.6, position=position_dodge()) +\n  labs(x = 'Milchkonsum',y='Anzahl')+\n  scale_fill_manual(\"\", values = c(\"3x und mehr pro Tag\"= \"#c5b87c\", \"1-2x pro Tag\"=\"#008099\", \"5-6x pro Woche\"=\"#fad60d\", \"3-4x pro Woche\"=\"#9ed129\", \"1-2x pro Woche\"=\"#e64d00\", \"1-2x pro Monat\"=\"#80ccff\", \"nie\"=\"#262626\", \"Unbekannt\"=\"grey90\"))+\n  scale_x_discrete(labels = function(x) str_wrap(x, width = 10))+\n  mytheme+\n  ggsave(\"S:/pools/n/N-IUNR-nova-data/01_befragung/quant/01_analysen/06_explorative/Plots/Milchkonsum.pdf\",\n         width = 18,\n         height = 8,\n         dpi=600,\n         units=\"in\",\n         device=\"pdf\")\n\nggplot(df_, aes(veget, fill=veget))+\n  geom_bar(stat=\"count\",width = 0.6, position=position_dodge()) +\n  labs(x = 'Vegetarische Ernährung',y='Anzahl')+\n  scale_fill_manual(\"\", values = c(\"immer\"= \"#c5b87c\", \"meistens\"=\"#008099\", \"oft\"=\"#fad60d\", \"manchmal\"=\"#9ed129\", \"selten\"=\"#e64d00\", \"nie\"=\"#262626\", \"Unbekannt\"=\"grey90\"))+\n  scale_x_discrete(labels = function(x) str_wrap(x, width = 10))+\n  mytheme+\n  ggsave(\"S:/pools/n/N-IUNR-nova-data/01_befragung/quant/01_analysen/06_explorative/Plots/vegetarische_Ernährung.pdf\",\n         width = 18,\n         height = 8,\n         dpi=600,\n         units=\"in\",\n         device=\"pdf\")\n\nggplot(df_, aes(veg, fill=veg))+\n  geom_bar(stat=\"count\", width = 0.6, position=position_dodge()) +\n  labs(x = 'Vegane Ernährung',y='Anzahl')+\n  scale_fill_manual(\"\", values = c(\"immer\"= \"#c5b87c\", \"meistens\"=\"#008099\", \"oft\"=\"#fad60d\", \"manchmal\"=\"#9ed129\", \"selten\"=\"#e64d00\", \"nie\"=\"#262626\", \"Unbekannt\"=\"grey90\"))+\n  scale_x_discrete(labels = function(x) str_wrap(x, width = 10))+\n  mytheme+\n  ggsave(\"S:/pools/n/N-IUNR-nova-data/01_befragung/quant/01_analysen/06_explorative/Plots/vegane_Ernährung.pdf\",\n         width = 18,\n         height = 8,\n         dpi=600,\n         units=\"in\",\n         device=\"pdf\")\n  \n#Piechart für Verpflegungstyp, nur einmal ausgefüllt\n\ndf_<- read_delim(\"S:\\\\pools\\\\n\\\\N-IUNR-nova-data\\\\01_befragung\\\\quant\\\\01_analysen\\\\03_bereinigung\\\\02_alle\\\\bereinigter_grundatensatz_fb_180503_04vori.csv\",  delim = ';', locale=locale(encoding = \"ISO-8859-2\"))\ndf_ <- subset(df_, fill==0)\n\ntable(df_$Verpflegungstyp)\nVerpflegungstyp.n <- c(  'Mensagänger (379)'=379, 'Selbstverpfleger (268)'=268, 'Abwechsler(101)'=101, 'Einkäufer (18)'=18, 'Unbekannt (3)'=3)\n\npiepercent<- round(100*Verpflegungstyp.n/sum(Verpflegungstyp.n), 1)\npielabels<- paste(piepercent, \"%\", sep=\"\")\n\npie(Verpflegungstyp.n, labels= pielabels, col = c(\"#c5b87c\", \"#008099\", \"#fad60d\", \"#9ed129\", \"#e64d00\"))\nlegend(\"topright\", c(\"Mensagänger\",\"Selbstverpfleger\",\"Abwechsler\",\"Einkäufer\", \"Unbekannt\"), cex=0.8, fill=c(\"#c5b87c\", \"#008099\", \"#fad60d\", \"#9ed129\", \"#e64d00\"))+\n\n\n\n# \n# df_$Verpflegungstyp <- factor(df_$Verpflegungstyp, levels = c(\"Mensagänger\", \"Selbstverpfleger\", \"Abwechsler\", \"Einkäufer\", \"Unbekannt\"))\n# df_$Verpflegungstyp[is.na(df_$Verpflegungstyp)]=\"Unbekannt\"\n# table(df_$Verpflegungstyp)\n# Verpflegungstyp.n <- c(  'Mensagänger (379)'=379, 'Selbstverpfleger (268)'=268, 'Abwechsler(101)'=101, 'Einkäufer (18)'=18, 'Unbekannt (3)'=3)\n# \n# loadfonts(device = \"win\")\n# waffle(Verpflegungstyp.n/5, rows = 10, glyph_size = 5, colors=c(\"#c5b87c\", \"#008099\", \"#fad60d\", \"#9ed129\", \"grey90\"),\n#        title = \"Verpflegungstypen\", xlab=\"Eine Kasten entspricht 5 Personen\")+\nggsave(\"S:/pools/n/N-IUNR-nova-data/01_befragung/quant/01_analysen/06_explorative/Plots/Verpflegungstypen.png\",\n       width = 8,\n       height = 8,\n       dpi=600,\n       units=\"in\",\n       device=\"png\")\n\n#Piechart für die Zufriedenheit, mehrmals ausgefüllt.\ndf_<- read_delim(\"S:\\\\pools\\\\n\\\\N-IUNR-nova-data\\\\01_befragung\\\\quant\\\\01_analysen\\\\03_bereinigung\\\\02_alle\\\\bereinigter_grundatensatz_fb_180503_04vori.csv\",  delim = ';', locale=locale(encoding = \"ISO-8859-2\"))\ndf_<-subset(df_, df_$mensa==1)\n\ndf_$satis_1 = factor(df_$satis_1, levels = c (1:4,\"NA\"), labels = c(\"trifft nicht zu\", \"trifft eher nicht zu\",\"trifft eher zu\",\"trifft zu\", \"Unbekannt\"))\ndf_$satis_1[is.na(df_$satis_1)]=\"Unbekannt\"\n\ndf_$satis_2 = factor(df_$satis_2, c (1:4,\"NA\"), labels = c(\"trifft nicht zu\", \"trifft eher nicht zu\",\"trifft eher zu\",\"trifft zu\", \"Unbekannt\"))\ndf_$satis_2[is.na(df_$satis_2)]=\"Unbekannt\"\n\ndf_$satis_3 = factor(df_$satis_3, c (1:4,\"NA\"), labels = c(\"trifft nicht zu\", \"trifft eher nicht zu\",\"trifft eher zu\",\"trifft zu\", \"Unbekannt\"))\ndf_$satis_3[is.na(df_$satis_3)]=\"Unbekannt\"\n\n\nggplot(df_, aes(satis_2, fill=satis_2))+\n  geom_bar(stat=\"count\",width = 0.6, position=position_dodge()) +\n  labs(x = 'Zufriedenheit',y='Anzahl')+\n  scale_fill_manual(\"\", values = c(\"trifft zu\"= \"#c5b87c\", \"trifft eher zu\"=\"#008099\", \"trifft eher nicht zu\"=\"#fad60d\", \"trifft nicht zu\"=\"#9ed129\", \"Unbekannt\"=\"grey90\"))+\n  scale_x_discrete(labels = function(x) str_wrap(x, width = 10))+\n  mytheme+\n  ggsave(\"S:/pools/n/N-IUNR-nova-data/01_befragung/quant/01_analysen/06_explorative/Plots/Zufriedenheit.pdf\",\n         width = 18,\n         height = 8,\n         dpi=600,\n         units=\"in\",\n         device=\"pdf\")\n\n\n\n# table(df_$satis_2)\n# \n# Zufriedenheit.n2 <- c(  \"trifft nicht zu (26)\"=26, \"trifft eher nicht zu(85)\"=85,\"trifft eher zu (380)\"=380,\"trifft zu (376)\"=376, \"Unbekannt(7)\"=7)\n\n# loadfonts(device = \"win\")\n# waffle(Zufriedenheit.n2/5, rows = 10, use_glyph = \"child\", glyph_size = 7, colors=c(\"#c5b87c\", \"#008099\", \"#fad60d\", \"#6619e6\", \"#99f200\"),\n#        title = \"Ich fand das Menü gut\", xlab=\"Eine Figur entspricht 5 Personen\")+\n#   ggsave(\"S:/pools/n/N-IUNR-nova-data/01_befragung/quant/01_analysen/06_explorative/Plots/Zufriedenheit.png\",\n#          width = 12,\n#          height = 8,\n#          dpi=600,\n#          units=\"in\",\n#          device=\"png\")\n\n\n",
    "created" : 1532517712575.000,
    "dirty" : false,
    "encoding" : "ISO8859-1",
    "folds" : "",
    "hash" : "653716469",
    "id" : "DA2E2210",
    "lastKnownWriteTime" : 1530640243,
    "last_content_update" : 1530640243,
    "path" : "S:/pools/n/N-IUNR-nova-data/01_befragung/quant/01_analysen/06_explorative/Fragebogen_verteilt_180621_02vori.R",
    "project_path" : null,
    "properties" : {
    },
    "relative_order" : 6,
    "source_on_save" : false,
    "source_window" : "",
    "type" : "r_source"
}